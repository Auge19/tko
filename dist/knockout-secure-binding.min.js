/*! knockout-secure-binding - v0.0.4 - 2013-12-12
 *  https://github.com/brianmhunt/knockout-secure-binding
 *  Copyright (c) 2013 Brian M Hunt; License: MIT */
!function(a){"function"==typeof define&&define.amd?define(["knockout","exports"],a):a(ko)}(function(a,b){function c(a,b,c){var d=a[0].name;return"$context"===d?(a.shift(),b):"$element"===d?(a.shift(),c):b&&b.$data&&Object.hasOwnProperty.call(b.$data,d)?b.$data:b&&Object.hasOwnProperty.call(b,d)?b:j}function d(a,b,d){function e(){var a=c(g,b,d);return g.forEach(function(b){a=b.execute(b.name,a)}),a}var f=a.split("."),g=[];return f.forEach(function(a){var b,c,d=a.length;"()"==a.substr(d-2)?(b=a.slice(0,d-2),c="fn"):(b=a,c="id"),g.push({name:b,execute:k[c]})}),e}function e(b){new a.bindingProvider;b=b||{},this.attribute=b.attribute||"data-sbind",j=b.globals||{},this.virtualAttribute=b.virtualAttribute||"ksb ",this.bindings=b.bindings||a.bindingHandlers}function f(b){a.utils.extend(this.bindings,b)}function g(a){var b,c;return a.nodeType===a.ELEMENT_NODE?b=a.getAttribute(this.attribute):a.nodeType===a.COMMENT_NODE&&(c=""+a.nodeValue||a.text,b=c.indexOf(this.virtualAttribute)>-1),b}function h(a,b){var c,d={};return a.nodeType===a.ELEMENT_NODE&&(c=a.getAttribute(this.attribute)),c&&(d=i(c,a,b)),d}var i,j=(new RegExp("[_A-Za-z]"),new RegExp("_A-Za-z0-9]"),new RegExp("_A-Za-z]"),new RegExp("_A-Za-z0-9.]"),{}),k={id:function(a,b){return b?b[a]:void 0},fn:function(a,b){return b?b[a]():void 0}};return i=function(){var b,c,e,f,g={"'":"'",'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:"\n",r:"\r",t:"	"},h=function(a){throw{name:"SyntaxError",message:a,at:b,text:e}},i=function(a){return a&&a!==c&&h("Expected '"+a+"' instead of '"+c+"'"),c=e.charAt(b),b+=1,c},j=function(){var a="";for(m();c;){if(":"===c||" "===c)return a;a+=c,i()}return a},k=function(){var a,b="";for("-"===c&&(b="-",i("-"));c>="0"&&"9">=c;)b+=c,i();if("."===c)for(b+=".";i()&&c>="0"&&"9">=c;)b+=c;if("e"===c||"E"===c)for(b+=c,i(),("-"===c||"+"===c)&&(b+=c,i());c>="0"&&"9">=c;)b+=c,i();return a=+b,isFinite(a)?a:(h("Bad number"),void 0)},l=function(){var a,b,d,e="";if('"'===c)for(;i();){if('"'===c)return i(),e;if("\\"===c)if(i(),"u"===c){for(d=0,b=0;4>b&&(a=parseInt(i(),16),isFinite(a));b+=1)d=16*d+a;e+=String.fromCharCode(d)}else{if("string"!=typeof g[c])break;e+=g[c]}else e+=c}else if("'"===c)for(;i();){if("'"===c)return i(),e;if("\\"===c)if(i(),"u"===c){for(d=0,b=0;4>b&&(a=parseInt(i(),16),isFinite(a));b+=1)d=16*d+a;e+=String.fromCharCode(d)}else{if("string"!=typeof g[c])break;e+=g[c]}else e+=c}h("Bad string")},m=function(){for(;c&&" ">=c;)i()},n=function(a,b,c){switch(c){case"true":return!0;case"false":return!1;case"null":return null;case"undefined":return void 0}return d(c,b,a)},o=function(a,b){var d="";for(m();c;){if(":"===c||"}"===c||","===c||" "===c||"]"===c)return n(a,b,d);d+=c,i()}return n(a,b,d)},p=function(){var a=[];if("["===c){if(i("["),m(),"]"===c)return i("]"),a;for(;c;){if(a.push(f()),m(),"]"===c)return i("]"),a;i(","),m()}}h("Bad array")},q=function(){var a,b={};if("{"===c){if(i("{"),m(),"}"===c)return i("}"),b;for(;c;){if(a='"'===c||"'"===c?l():j(),m(),i(":"),Object.hasOwnProperty.call(b,a)&&h('Duplicate key "'+a+'"'),b[a]=f(),m(),"}"===c)return i("}"),b;i(","),m()}}h("Bad object")},r=function(a,b){for(var d,e={};c;)d=j(),m(),i(":"),e[d]=f(a,b),m(),c&&i(",");return e};return f=function(a,b){switch(m(),c){case"{":return q();case"[":return p();case'"':case"'":return l();case"-":return k();default:return c>="0"&&"9">=c?k():o(a,b)}},function(d,f,g){var i;return e=d,b=0,c=" ",i=r(f,g),m(),c&&h("Syntax error"),a.utils.objectForEach(i,function(a,b){"function"!=typeof b&&(i[a]=function(){return b})}),i}}(),a.utils.extend(e.prototype,{registerBindings:f,nodeHasBindings:g,getBindingAccessors:h,parse:i,make_accessor:d}),b||(a.secureBindingsProvider=e),e});